(function(e){"use strict";var t=-1;var n=function(n){n.every=function(e,r,i){n._time();if(!i){i=r;r=null}t+=1;var s=t;n._timers[s]={visible:e,hidden:r,callback:i};n._run(s,false);if(n.isSupported()){n._listen()}return s};n.stop=function(e){if(!n._timers[e]){return false}n._stop(e);delete n._timers[e];return true};n._timers={};n._time=function(){if(n._timed){return}n._timed=true;n._wasHidden=n.hidden();n.change(function(){n._stopRun();n._wasHidden=n.hidden()})};n._run=function(t,r){var i,s=n._timers[t];if(n.hidden()){if(null===s.hidden){return}i=s.hidden}else{i=s.visible}var o=function(){s.last=new Date;s.callback.call(e)};if(r){var u=new Date;var a=u-s.last;if(i>a){s.delay=setTimeout(function(){o();s.id=setInterval(o,i)},i-a)}else{o();s.id=setInterval(o,i)}}else{s.id=setInterval(o,i)}};n._stop=function(e){var t=n._timers[e];clearInterval(t.id);clearTimeout(t.delay);delete t.id;delete t.delay};n._stopRun=function(e){var t=n.hidden(),r=n._wasHidden;if(t&&!r||!t&&r){for(var i in n._timers){n._stop(i);n._run(i,!t)}}};return n};if(typeof module!="undefined"&&module.exports){module.exports=n(require("./visibility.core"))}else{n(e.Visibility)}})(window)